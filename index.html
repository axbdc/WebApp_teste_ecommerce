<!doctype html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR.js World Tracking (Sem Marcador)</title>
    <!-- Carrega Tailwind CSS para estilização da interface -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>

    <!-- Scripts do A-Frame e AR.js -->
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <!-- Nota: Usaremos o aframe-ar.js, que suporta World Tracking (markerless) -->
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <script src="https://raw.githack.com/donmccurdy/aframe-extras/master/dist/aframe-extras.loaders.min.js"></script>
    <!-- Componentes de gestos (movimento, rotação) -->
    <script src="https://raw.githack.com/AR-js-org/studio-backend/master/src/modules/marker/tools/gesture-detector.js"></script>
    <script src="https://raw.githack.com/AR-js-org/studio-backend/master/src/modules/marker/tools/gesture-handler.js"></script>

    <style>
        /* Estilo para garantir que o A-Frame preencha a tela */
        #scene {
            width: 100vw;
            height: 100vh;
        }

        /* Estilização para o overlay de mensagem */
        .message-overlay {
            z-index: 10;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            pointer-events: none;
            text-align: center;
        }
    </style>
</head>

<body class="m-0 overflow-hidden font-sans">
    
    <!-- Mensagem de orientação para o usuário -->
    <div class="message-overlay bg-white/70 p-4 rounded-lg shadow-xl backdrop-blur-sm">
        <p class="text-lg font-bold text-gray-800">Modelo 3D no Ambiente (World Tracking)</p>
        <p class="text-sm text-gray-600 mt-1">O modelo aparecerá 2 metros à sua frente. Use os dedos para mover, girar e dimensionar.</p>
    </div>

    <a-scene
        vr-mode-ui="enabled: false;"
        loading-screen="enabled: false;"
        renderer="logarithmicDepthBuffer: true;"
        
        <!-- Configuração AR.js para World Tracking/Slam-Based AR -->
        <!-- Removemos todas as menções a 'marker' ou 'pattern' -->
        <!-- O parâmetro 'trackingMethod: best' é suficiente para habilitar o World Tracking sem marcadores -->
        arjs="sourceType: webcam; trackingMethod: best; debugUIEnabled: false;"
        
        id="scene"
        embedded
        gesture-detector
    >
        <a-assets>
            <!-- Substituí o caminho local por um placeholder GLB para garantir que o código funcione. -->
            <!-- TROQUE ESTE URL PELO SEU GLB COMPLETO: "assets/asset.glb" -->
            <a-asset-item
                id="animated-asset"
                src="mouse.glb"
            ></a-asset-item>
        </a-assets>

        <!-- O MODELO 3D AGORA ESTÁ DIRETAMENTE DENTRO DA CENA -->
        <!-- Ele será renderizado no mundo real, independentemente de um marcador. -->
        <a-entity
            id="main-model"
            gltf-model="#animated-asset"
            
            <!-- Posicionamento inicial: 0.5m acima do chão, 2m à frente (0 -0.5 -2) -->
            <!-- Ajuste a posição Y se o modelo estiver afundando no chão. -->
            position="0 -0.5 -2" 
            
            scale="1 1 1"
            animation-mixer="loop: repeat"
            
            class="clickable"
            gesture-handler
        ></a-entity>

        <!-- A-Frame Camera (já configurada para ser a câmera AR do AR.js) -->
        <a-entity camera></a-entity>
    </a-scene>
</body>
</html>
